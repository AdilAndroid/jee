<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<!-- Mapping file autogenerated by MyEclipse Persistence Tools -->
<hibernate-mapping>

<!-- 
# 如果需要删除需要先解除关联关系
# ALTER TABLE ORDERS DROP FOREIGN KEY FK_CUSTOMER_ID;
DROP TABLE IF EXISTS CUSTOMER;
CREATE TABLE IF NOT EXISTS CUSTOMER (	
	ID BIGINT NOT NULL PRIMARY KEY,
	NAME VARCHAR(15)
);

DROP TABLE IF EXISTS ORDERS;
CREATE TABLE IF NOT EXISTS ORDERS (	
	ID BIGINT NOT NULL PRIMARY KEY,
	ORDER_NUMBER VARCHAR(15),
	CUSTOMER_ID BIGINT NOT NULL
);

 #改变orders表结构
 #添加索引，索引名为IDEX_CUSTOMER_ID，字段是CUSTOMER_ID
 #添加外键约束，名称是FK_CUSTOMER_ID，约束类型是外键约束(FOREIGN KEY)，列名是CUSTOMER_ID，引用CUSTOMER表中的ID字段
ALTER TABLE ORDERS ADD INDEX IDX_CUSTOMER_ID(CUSTOMER_ID),
	ADD CONSTRAINT FK_CUSTOMER_ID FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(ID);
 -->
 
	<class name="com.freesoft.bean.Customer" table="CUSTOMER" catalog="hibernate">
		<id name="id" type="long" column="ID">
			<generator class="increment" />
		</id>
		<property name="name" type="string">
			<column name="name" length="15" />
		</property>

<!-- cascade，设置所有操作custom的时候，必须同时操作orders -->
<!-- inverse，由order这一方面维护这份关联关系 -->
 <!-- 使用lazy=false取消延迟加载特性，这样可以使得查找一这一方时立即加载多方 -->
		<set name="orders" cascade="all" inverse="true" lazy="false">
			<key column="CUSTOMER_ID"></key>
			<one-to-many class="com.freesoft.bean.Order" />
		</set>
	</class>
</hibernate-mapping>
